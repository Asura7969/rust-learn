# Atomic

## 内存顺序

内存顺序是指`CPU`在访问内存时的顺序，该顺序可能受以下因素影响：

* 代码中的先后顺序
* 编译器优化导致在编译阶段发生改变（内存重排序）
* 运行阶段因CPU的缓存机制导致顺序被打乱

## 限定内存顺序的5个规则

* **Relaxed** 这是最宽松的原则，他对`CPU`*和编译器不做任何限制
* **Release** 设定内存屏障（`Memory Barrier`），保证他之前的操作永远在他之前，但是他后面的操作可能被重排到他前面
* **Acquire** 设定内存屏障，保证在它之后的访问永远在它之后，但是它之前的操作却有可能被重排到它后面，往往和`Release`在不同线程中联合使用
* **AcqRel** 是`Acquire`和`Release`的结合，同时拥有它俩提供保证。
* **SeqCst** 顺序一致性，`SeqCst`就像是`AcqRel`的加强版，它不管原子操作是属于读取还是写入的操作，只要某个线程有用到`SeqCst`的原子操作，线程中该`SeqCst`操作前的数据操作绝对不会被重新排在该`SeqCst`操作之后，且该`SeqCst`操作后的数据操作也绝对不会被重新排在`SeqCst`操作前。
